#!/bin/sh
# Run lint-staged for formatting and linting
npx lint-staged

# Check if there are any staged TypeScript files
if git diff --cached --name-only | grep -E '\.(ts|tsx)$' > /dev/null; then
  echo "ðŸ” Running TypeScript type checking..."
  
  # Check each workspace for TypeScript errors
  if git diff --cached --name-only | grep -E '^backend/.*\.(ts|tsx)$' > /dev/null; then
    echo "Checking backend types..."
    cd backend && npm run type-check || exit 1
    cd ..
  fi
  
  if git diff --cached --name-only | grep -E '^app/.*\.(ts|tsx)$' > /dev/null; then
    echo "Checking app types..."
    cd app && npm run type-check || exit 1
    cd ..
  fi
  
  if git diff --cached --name-only | grep -E '^crm/.*\.(ts|tsx)$' > /dev/null; then
    echo "Checking CRM types..."
    cd crm && npm run type-check || exit 1
    cd ..
  fi
  
  if git diff --cached --name-only | grep -E '^word-library/.*\.(ts|tsx)$' > /dev/null; then
    echo "Checking word-library types..."
    cd word-library && npm run type-check || exit 1
    cd ..
  fi
  
  echo "âœ… All TypeScript checks passed!"
fi
